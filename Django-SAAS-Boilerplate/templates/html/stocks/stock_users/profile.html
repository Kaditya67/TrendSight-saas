{% extends 'stocks/dashboard/base.html' %}

{% block title %}Profile{% endblock %}
{% block content %}
<div class="max-w-4xl mx-auto bg-white px-4 sm:px-6 md:px-8 py-10 rounded-lg shadow-lg">
    <h2 class="text-2xl sm:text-3xl font-semibold text-center mb-8 text-gray-800">Edit Profile</h2>
    
    <form method="post" enctype="multipart/form-data" class="space-y-6">
        {% csrf_token %}
        
        <!-- Email Field -->
        <div>
            <label for="id_email" class="text-base sm:text-lg font-medium text-gray-700 block mb-2">Email:</label>
            {{ form.email }}
        </div>
        
        <!-- Name Field -->
        <div>
            <label for="id_name" class="text-base sm:text-lg font-medium text-gray-700 block mb-2">Name:</label>
            {{ form.name }}
        </div>
        
        <!-- Profile Picture Section -->
        <div>
            <label for="id_dp" class="text-base sm:text-lg font-medium text-gray-700 block mb-2">Profile Picture:</label>
            <div class="flex flex-wrap items-center gap-4">
                {% if user.dp %}
                    <img src="{{ user.dp.url }}" alt="Profile Picture" 
                         class="h-20 w-20 sm:h-24 sm:w-24 object-cover rounded-full border-2 border-gray-300">
                    <div class="flex flex-col justify-center">
                        <span class="text-sm font-medium text-gray-600">Current Picture</span>
                        <span class="text-sm text-gray-400">{{ user.dp.name }}</span>
                    </div>
                {% endif %}
                
                <input type="file" name="dp" id="id_dp" 
                       class="border border-gray-300 rounded-lg py-2 px-4 w-full sm:w-auto text-sm font-medium text-gray-600 hover:border-gray-400 focus:ring-2 focus:ring-blue-600 focus:outline-none">
            </div>
            <div id="imagePreview" class="mt-4 hidden">
                <img id="previewImg" src="" alt="Image Preview" 
                     class="h-20 w-20 sm:h-24 sm:w-24 object-cover rounded-full border-2 border-gray-300">
            </div>
            <script>
                function previewImage(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const imgElement = document.getElementById('previewImg');
                            imgElement.src = e.target.result;
                            imgElement.parentElement.classList.remove('hidden');
                        };
                        reader.readAsDataURL(file);
                    }
                }
                document.getElementById('id_dp').addEventListener('change', previewImage);
            </script>
        </div>

        <!-- Phone Number Field -->
        <div>
            <label for="id_phone_no" class="text-base sm:text-lg font-medium text-gray-700 block mb-2">Phone Number:</label>
            {{ form.phone_no }}
        </div>
        
        <!-- Submit Button -->
        <div class="mt-8 flex flex-col sm:flex-row justify-between items-center gap-4">
            <!-- Update Profile Button -->
            <button type="submit" 
                    class="bg-blue-600 text-white font-semibold py-3 px-6 w-full sm:w-auto rounded-lg shadow-md hover:bg-blue-700 focus:ring-2 focus:ring-blue-600 focus:outline-none transition-all duration-300 ease-in-out transform hover:scale-105">
                Update Profile
            </button>
            
            <!-- Request Password Reset Button -->
            <a href="{% url 'password-reset' %}" 
               class="bg-red-600 text-white font-semibold py-3 px-6 w-full sm:w-auto rounded-lg shadow-md hover:bg-red-700 focus:ring-2 focus:ring-red-600 focus:outline-none transition-all duration-300 ease-in-out transform hover:scale-105">
                Request Password Reset
            </a>
        </div>
    </form> 
</div>
{% endblock %}
