{% extends "stocks/dashboard/base.html" %}
{% block title %} Stocks {% endblock %}

{% block content %}

<body class="font-sans bg-gray-100">
    <div class="container mx-auto my-4">
        <!-- Header Section -->
        <div class="flex justify-between items-center mb-12">
            <h1 class="text-4xl font-bold text-center text-gray-700 w-full">
                Stock Market Analysis Dashboard
            </h1>
        </div>

        <!-- EMA Trend Analysis -->
        <div class="row mb-4">
            <h5 class="mb-7 text-3xl bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600 text-center">
                Nifty 50 Trends
            </h5>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="card bg-white shadow-lg rounded-lg hover:shadow-xl transition-all">
                    <div class="text-center p-4">
                        <h5 class="text-lg font-semibold text-gray-800">Short-Term Trend (10 EMA)</h5>
                        <p class="text-gray-600">
                            <span class="font-bold text-green-600">Above</span> (Days: 
                            <span class="text-green-600 font-semibold">+3</span>)
                        </p>
                    </div>
                </div>
                <div class="card bg-white shadow-lg rounded-lg hover:shadow-xl transition-all">
                    <div class="text-center p-4">
                        <h5 class="text-lg font-semibold text-gray-800">Medium-Term Trend (20 EMA)</h5>
                        <p class="text-gray-600">
                            <span class="font-bold text-red-600">Below</span> (Days: 
                            <span class="text-red-600 font-semibold">-2</span>)
                        </p>
                    </div>
                </div>
                <div class="card bg-white shadow-lg rounded-lg hover:shadow-xl transition-all">
                    <div class="text-center p-4">
                        <h5 class="text-lg font-semibold text-gray-800">Long-Term Trend (30 EMA)</h5>
                        <p class="text-gray-600">
                            <span class="font-bold text-green-600">Above</span> (Days: 
                            <span class="text-green-600 font-semibold">+5</span>)
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sectoral Indices Bar Graph -->
        <div class="card mb-6 mt-12 shadow-2xl rounded-lg bg-white">
            <div class="card-body p-6">
                <h5 class="text-xl font-semibold text-center text-gray-800 mb-4">Sectoral EMA Performance</h5>
                <div class="flex justify-center">
                    <canvas id="sectorBarChart" class="w-4/5 h-96"></canvas>
                </div>
            </div>
        </div>

        <!-- Broader Market Trend Table -->
        <div class="card mb-6 mt-12 shadow-2xl rounded-lg">
            <div class="card-body p-6 bg-white">
                <h5 class="text-2xl font-semibold text-center bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600 mb-6">
                    Broader Market Trends - Daily
                </h5>
                <div class="mb-4">
                    <input type="search" id="search-broader-market" class="w-full form-control mb-4 p-2 border rounded"
                        placeholder="Search..." aria-label="Search">
                </div>
                <table id="broaderMarketTable" class="min-w-full border-collapse text-sm text-gray-700">
                    <thead>
                        <tr class="bg-gray-800 text-white">
                            <th class="py-3 px-6 font-medium text-left">Index</th>
                            <th class="py-3 px-6 font-medium text-left">10 EMA</th>
                            <th class="py-3 px-6 font-medium text-left">20 EMA</th>
                            <th class="py-3 px-6 font-medium text-left">30 EMA</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="hover:bg-gray-100 transition-all">
                            <td class="py-3 px-6 border-b border-gray-300 font-medium">Nifty 50</td>
                            <td class="py-3 px-6 border-b border-gray-300 font-bold text-green-600">+3 &#8593;</td>
                            <td class="py-3 px-6 border-b border-gray-300 font-bold text-red-600">-2 &#8595;</td>
                            <td class="py-3 px-6 border-b border-gray-300 font-bold text-green-600">+5 &#8593;</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Sectoral Indices Table -->
        <div class="card mb-6 mt-12 shadow-2xl rounded-lg bg-white">
            <div class="card-body p-6">
                <h5 class="card-title text-2xl font-semibold text-center bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600 mb-6">
                    Sectoral Indices - Daily
                </h5>
                <div class="mb-4">
                    <input type="search" id="search-sectoral-market" class="form-control mb-4 p-2 border rounded"
                        placeholder="Search..." aria-label="Search">
                </div>
                <table id="sectoralMarketTable" class="table-auto w-full text-center border-collapse text-sm text-gray-700">
                    <thead>
                        <tr class="bg-gray-800 text-white">
                            <th class="py-3 px-6 font-medium">Sector</th>
                            <th class="py-3 px-6 font-medium">10 EMA</th>
                            <th class="py-3 px-6 font-medium">20 EMA</th>
                            <th class="py-3 px-6 font-medium">30 EMA</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="hover:bg-gray-100 transition-all">
                            <td class="py-3 px-6 border-b border-gray-300">Nifty IT</td>
                            <td class="py-3 px-6 border-b border-gray-300 font-bold text-green-600">+4 &#8593;</td>
                            <td class="py-3 px-6 border-b border-gray-300 font-bold text-red-600">-2 &#8595;</td>
                            <td class="py-3 px-6 border-b border-gray-300 font-bold text-green-600">+6 &#8593;</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const sectorLabels = ["Banks", "Auto", "IT", "Pharma"];
        const performanceCounts = [5, -3, 7, -2];
        const ctx = document.getElementById('sectorBarChart').getContext('2d');

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: sectorLabels,
                datasets: [{
                    label: 'Performance',
                    data: performanceCounts,
                    backgroundColor: performanceCounts.map(value => value >= 0 ? 'rgba(34, 197, 94, 0.7)' : 'rgba(239, 68, 68, 0.7)'),
                    borderColor: performanceCounts.map(value => value >= 0 ? 'rgba(34, 197, 94, 1)' : 'rgba(239, 68, 68, 1)'),
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    tooltip: { enabled: true }
                },
                scales: {
                    x: { title: { display: true, text: 'Sectors' } },
                    y: { beginAtZero: true, title: { display: true, text: 'Performance Count' } }
                }
            }
        });
    </script>
</body>

{% endblock %}
